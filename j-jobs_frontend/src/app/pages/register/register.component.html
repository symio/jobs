<!-- src/app/pages/register/register.component.html -->
<main class="register-container">
    <section class="main-title-section">
        <h1 class="main-title">Inscription</h1>
    </section>

    <div class="register-form">
        <section class="content-section">
            <!-- Messages d'erreur -->
            <div *ngIf="error" class="alert alert-error">
                {{ error }}
            </div>

            <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
                <!-- name -->
                <div
                    class="form-group"
                    [class.is-invalid]="name?.invalid && name?.touched"
                    >
                    <label for="name" class="form-label required">Nom</label>
                    <input
                        type="text"
                        id="name"
                        formControlName="name"
                        [class.error]="name?.invalid && name?.touched"
                        placeholder="Entrez votre nom"
                        autocomplete="name"
                        />
                    <div *ngIf="name?.invalid && name?.touched" class="error-message">
                        <div *ngIf="name?.errors?.['required']">Le nom est requis</div>
                    </div>
                </div>
                <!-- firstname -->
                <div
                    class="form-group"
                    [class.is-invalid]="firstname?.invalid && firstname?.touched"
                    >
                    <label for="firstname" class="form-label required">Prénom</label>
                    <input
                        type="text"
                        id="firstname"
                        formControlName="firstname"
                        [class.error]="firstname?.invalid && firstname?.touched"
                        placeholder="Entrez votre prénom"
                        autocomplete="firstname"
                        />
                    <div
                        *ngIf="firstname?.invalid && firstname?.touched"
                        class="error-message"
                        >
                        <div *ngIf="firstname?.errors?.['required']">
                            Le prénom est requis
                        </div>
                    </div>
                </div>
                <!-- Email -->
                <div
                    class="form-group"
                    [class.is-invalid]="email?.invalid && email?.touched"
                    >
                    <label for="email" class="form-label required">E-Mail</label>
                    <input
                        type="email"
                        id="email"
                        formControlName="email"
                        [class.error]="email?.invalid && email?.touched"
                        placeholder="Entrez votre e-mail"
                        autocomplete="username"
                        />
                    <div *ngIf="email?.invalid && email?.touched" class="error-message">
                        <div *ngIf="email?.errors?.['required']">
                            L'adresse e-mail est requise
                        </div>
                        <div *ngIf="email?.errors?.['email']">
                            Veuillez entrer une adresse e-mail valide
                        </div>
                    </div>
                </div>
                <!-- Mot de passe -->
                <div
                    class="form-group"
                    [class.is-invalid]="password?.invalid && password?.touched"
                    >
                    <label for="password" class="form-label required">Mot de passe</label>
                    <div class="password-input-container">
                        <input
                            [type]="passwordVisible ? 'text' : 'password'"
                            id="password"
                            formControlName="password"
                            [class.error]="password?.invalid && password?.touched"
                            placeholder="Entrez votre mot de passe"
                            autocomplete="current-password"
                            />
                        <button type="button" class="toggle-password-btn" (click)="togglePasswordVisibility()">
                            <svg *ngIf="passwordVisible" class="iconeMobile eyeOpen" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.19 512.19" width="512" height="512">
                            <g>
                            <circle cx="256.095" cy="256.095" r="85.333"></circle>
                            <path d="M496.543,201.034C463.455,147.146,388.191,56.735,256.095,56.735S48.735,147.146,15.647,201.034 c-20.862,33.743-20.862,76.379,0,110.123c33.088,53.888,108.352,144.299,240.448,144.299s207.36-90.411,240.448-144.299 C517.405,277.413,517.405,234.777,496.543,201.034z M256.095,384.095c-70.692,0-128-57.308-128-128s57.308-128,128-128 s128,57.308,128,128C384.024,326.758,326.758,384.024,256.095,384.095z"></path>
                            </g>
                            </svg>

                            <svg *ngIf="!passwordVisible" class="iconeMobile eyeClose" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.19 512.19" width="512" height="512">
                            <g>
                            <path d="M496.543,200.771c-19.259-31.537-43.552-59.707-71.915-83.392l59.733-59.733c8.185-8.475,7.95-21.98-0.525-30.165 c-8.267-7.985-21.374-7.985-29.641,0l-64.96,65.045c-40.269-23.918-86.306-36.385-133.141-36.053 c-132.075,0-207.339,90.411-240.448,144.299c-20.862,33.743-20.862,76.379,0,110.123c19.259,31.537,43.552,59.707,71.915,83.392 l-59.733,59.733c-8.475,8.185-8.71,21.691-0.525,30.165c8.185,8.475,21.691,8.71,30.165,0.525c0.178-0.172,0.353-0.347,0.525-0.525 l65.109-65.109c40.219,23.915,86.201,36.402,132.992,36.117c132.075,0,207.339-90.411,240.448-144.299 C517.405,277.151,517.405,234.515,496.543,200.771z M128.095,255.833c-0.121-70.575,56.992-127.885,127.567-128.006 c26.703-0.046,52.75,8.275,74.481,23.793l-30.976,30.976c-13.004-7.842-27.887-12.022-43.072-12.096 c-47.128,0-85.333,38.205-85.333,85.333c0.074,15.185,4.254,30.068,12.096,43.072l-30.976,30.976 C136.414,308.288,128.096,282.394,128.095,255.833z M256.095,383.833c-26.561-0.001-52.455-8.319-74.048-23.787l30.976-30.976 c13.004,7.842,27.887,12.022,43.072,12.096c47.128,0,85.333-38.205,85.333-85.333c-0.074-15.185-4.254-30.068-12.096-43.072 l30.976-30.976c41.013,57.434,27.702,137.242-29.732,178.255C308.845,375.558,282.798,383.879,256.095,383.833z"></path>
                            </g>
                            </svg>
                        </button>
                    </div>
                    <div
                        *ngIf="password?.invalid && password?.touched"
                        class="error-message"
                        >
                        <div *ngIf="password?.errors?.['required']">
                            Le mot de passe est requis
                        </div>
                        <div *ngIf="password?.errors?.['pattern']">
                            Le mot de passe doit contenir au moins 8 caractères, une lettre,
                            un chiffre et un caractère spécial
                        </div>
                    </div>
                </div>
                <div
                    class="form-group"
                    [class.is-invalid]="
                    passwordConfirm?.invalid && passwordConfirm?.touched
                    "
                    >
                    <label for="passwordConfirm" class="form-label required"
                           >Confirmation du mot de passe</label
                    >
                    <div class="password-input-container">
                        <input
                            [type]="passwordVisible ? 'text' : 'password'"
                            id="passwordConfirm"
                            formControlName="passwordConfirm"
                            [class.error]="
                            (passwordConfirm?.invalid && passwordConfirm?.touched) ||
                            registerForm.hasError('passwordsMismatch')
                            "
                            placeholder="Entrez votre mot de passe"
                            autocomplete="current-passwordConfirm"
                            />
                        <button type="button" class="toggle-password-btn" (click)="togglePasswordVisibility()">
                            <svg *ngIf="passwordVisible" class="iconeMobile eyeOpen" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.19 512.19" width="512" height="512">
                            <g>
                            <circle cx="256.095" cy="256.095" r="85.333"></circle>
                            <path d="M496.543,201.034C463.455,147.146,388.191,56.735,256.095,56.735S48.735,147.146,15.647,201.034 c-20.862,33.743-20.862,76.379,0,110.123c33.088,53.888,108.352,144.299,240.448,144.299s207.36-90.411,240.448-144.299 C517.405,277.413,517.405,234.777,496.543,201.034z M256.095,384.095c-70.692,0-128-57.308-128-128s57.308-128,128-128 s128,57.308,128,128C384.024,326.758,326.758,384.024,256.095,384.095z"></path>
                            </g>
                            </svg>

                            <svg *ngIf="!passwordVisible" class="iconeMobile eyeClose" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.19 512.19" width="512" height="512">
                            <g>
                            <path d="M496.543,200.771c-19.259-31.537-43.552-59.707-71.915-83.392l59.733-59.733c8.185-8.475,7.95-21.98-0.525-30.165 c-8.267-7.985-21.374-7.985-29.641,0l-64.96,65.045c-40.269-23.918-86.306-36.385-133.141-36.053 c-132.075,0-207.339,90.411-240.448,144.299c-20.862,33.743-20.862,76.379,0,110.123c19.259,31.537,43.552,59.707,71.915,83.392 l-59.733,59.733c-8.475,8.185-8.71,21.691-0.525,30.165c8.185,8.475,21.691,8.71,30.165,0.525c0.178-0.172,0.353-0.347,0.525-0.525 l65.109-65.109c40.219,23.915,86.201,36.402,132.992,36.117c132.075,0,207.339-90.411,240.448-144.299 C517.405,277.151,517.405,234.515,496.543,200.771z M128.095,255.833c-0.121-70.575,56.992-127.885,127.567-128.006 c26.703-0.046,52.75,8.275,74.481,23.793l-30.976,30.976c-13.004-7.842-27.887-12.022-43.072-12.096 c-47.128,0-85.333,38.205-85.333,85.333c0.074,15.185,4.254,30.068,12.096,43.072l-30.976,30.976 C136.414,308.288,128.096,282.394,128.095,255.833z M256.095,383.833c-26.561-0.001-52.455-8.319-74.048-23.787l30.976-30.976 c13.004,7.842,27.887,12.022,43.072,12.096c47.128,0,85.333-38.205,85.333-85.333c-0.074-15.185-4.254-30.068-12.096-43.072 l30.976-30.976c41.013,57.434,27.702,137.242-29.732,178.255C308.845,375.558,282.798,383.879,256.095,383.833z"></path>
                            </g>
                            </svg>
                        </button>
                    </div>
                    <div
                        *ngIf="
                        passwordConfirm?.touched &&
                        (passwordConfirm?.invalid ||
                        registerForm.hasError('passwordsMismatch'))
                        "
                        class="error-message"
                        >
                        <div *ngIf="passwordConfirm?.errors?.['required']">
                            La confirmation du mot de passe est requise
                        </div>
                        <div *ngIf="registerForm.hasError('passwordsMismatch')">
                            Les mots de passe ne correspondent pas
                        </div>
                    </div>
                </div>
                <!-- gdproptin -->
                <div
                    class="form-group checkbox-group gdproptin-group"
                    [class.is-invalid]="gdproptin?.invalid && gdproptin?.touched"
                    >
                    <input type="checkbox" formControlName="gdproptin" id="gdproptin" />
                    <label for="gdproptin" class="form-label required">
                        &nbsp;Je reconnais avoir pris connaissance des
                        <a routerLink="/mentions-legales" class="primary-link" target="_blank">mentions légales</a> 
                        et accepter les <a routerLink="/confidentialite" class="primary-link" target="_blank">règles de confidentialité</a>
                    </label>

                    <div
                        *ngIf="gdproptin?.invalid && gdproptin?.touched"
                        class="error-message"
                        >
                        Vous devez accepter les conditions d’utilisation
                    </div>
                </div>
                <!-- Bouton de soumission -->
                <div class="cta-section">
                    <button
                        type="submit"
                        class="cta-button primary"
                        [disabled]="registerForm.invalid || loading"
                        >
                        <span *ngIf="loading" class="loading-text">Envoi en cours...</span>
                        <span *ngIf="!loading">Envoyer</span>
                    </button>
                </div>

                <!-- Liens -->
                <div class="links-section">
                    <p>
                        Déjà membre ?
                        <a routerLink="/login" class="primary-link">Connexion</a>
                    </p>
                </div>
            </form>
        </section>
    </div>
</main>
